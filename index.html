<head>
  <script>
    (async()=>{
      await navigator.serviceWorker.register("sw.js?a=b#c", {type: 'module'})
      console.log('1', navigator.serviceWorker.controller)
      await navigator.serviceWorker.controller || new Promise(r => addEventListener("controllerchange", (event) => r(navigator.serviceWorker.controller)))
      console.log('2', navigator.serviceWorker.controller)
      console.log(await fetch('fs/').then(r=>r.json()))
    })()
  </script>
</head>
<body>
  test
</body>
